select_by_id: |
  SELECT 
    id,
    username,
    email,
    is_active,
    is_superuser,
    created_at,
    updated_at
  FROM users 
  WHERE id = {{ user_id }}

select_all: |
  SELECT 
    id,
    username,
    email,
    is_active,
    is_superuser,
    created_at,
    updated_at
  FROM users
  {% if limit %}
  LIMIT {{ limit }}
  {% endif %}
  {% if offset %}
  OFFSET {{ offset }}
  {% endif %}

select_active: |
  SELECT 
    id,
    username,
    email,
    created_at,
    updated_at
  FROM users 
  WHERE is_active = true
  ORDER BY created_at DESC
  {% if limit %}
  LIMIT {{ limit }}
  {% endif %}

select_by_email: |
  SELECT 
    id,
    username,
    email,
    is_active,
    created_at
  FROM users 
  WHERE email = '{{ email }}'

select_with_profile: |
  SELECT 
    u.id,
    u.username,
    u.email,
    u.is_active,
    up.first_name,
    up.last_name,
    up.phone,
    u.created_at
  FROM users u
  LEFT JOIN user_profiles up ON u.id = up.user_id
  {% if user_id %}
  WHERE u.id = {{ user_id }}
  {% endif %}
  ORDER BY u.created_at DESC

select_by_domain: |
  SELECT 
    id,
    username,
    email,
    created_at
  FROM users 
  WHERE email LIKE '%@{{ domain }}'
  ORDER BY created_at DESC
  {% if limit %}
  LIMIT {{ limit }}
  {% endif %}

count_total: |
  SELECT COUNT(*) as total_users
  FROM users
  {% if is_active is defined %}
  WHERE is_active = {{ is_active }}
  {% endif %}

insert: |
  INSERT INTO users (username, email, password_hash, is_active, is_superuser)
  VALUES ('{{ username }}', '{{ email }}', '{{ password_hash }}', {{ is_active | default(value=true) }}, {{ is_superuser | default(value=false) }})
  RETURNING id, username, email, created_at

update_by_id: |
  UPDATE users 
  SET 
    {% if username %}username = '{{ username }}',{% endif %}
    {% if email %}email = '{{ email }}',{% endif %}
    {% if is_active is defined %}is_active = {{ is_active }},{% endif %}
    updated_at = NOW()
  WHERE id = {{ user_id }}
  RETURNING id, username, email, is_active, updated_at

delete_by_id: |
  DELETE FROM users 
  WHERE id = {{ user_id }}
  RETURNING id, username, email